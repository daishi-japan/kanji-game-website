# UI/UXデザイン仕様書 (Design Specification)

## 1. デザイン原則 (Design Principles)

本プロジェクトは、7歳の子供（小学校1年生）が「勉強」と意識せずに没頭できる「攻略型エンターテインメント」を目指します。
Shadcn UI (Tailwind CSS) をベースにしつつ、ターゲット層に合わせてカスタマイズを行います。

### 1.1. コンセプト: "Adventure & Mastery"
*   **冒険 (Adventure):** 「読み」パート。ワクワクするような世界観。数字が増える、色がつく、音が鳴る。
*   **修練 (Mastery):** 「書き」パート。静かな集中。自分の手で書く行為そのものが魔法（奥義）となる体験。
*   **直感 (Intuitive):** 説明書なしで遊べる。文字（特に漢字）に頼りすぎず、アイコンや色で誘導する。

### 1.2. ターゲット（7歳児・よりちゃん）への最適化
*   **ひらがなファースト:** UI上のテキストは基本的に「ひらがな」または「小学1年生で習う漢字」のみを使用。
*   **大きなタッチターゲット:** 指先での操作を想定し、ボタンやインタラクティブ要素は大きめに設計（`min-height: 48px` 推奨）。
*   **即時フィードバック:** アクション（タップ、正解、レベルアップ）に対して、0.1秒以内に視覚・聴覚的な反応を返す。

---

## 2. トーン＆マナー (Tone & Manner)

Shadcn UIの洗練された基盤を活かしつつ、モード（読み/書き）に応じて異なるアクセントを加えます。

### 2.1. カラーパレット (Color Palette)
ベースはクリーンな白・グレー基調ですが、アクションやポジティブな状態には鮮やかな色を使用します。

*   **Base (Background):** `Warning` や `Warmth` を感じるわずかに温かみのある白（`#FAFAF9` / Stone-50 相当）。
*   **Primary Action (Adventure):** 冒険心をくすぐる、元気で前向きな「オレンジ (`#F97316` / Orange-500)」。
*   **Secondary Action (Writing/Zen):** 集中力を高める、深く落ち着いた「藍色 (`#4338CA` / Indigo-700)」または「墨色」。
*   **Success (Correct):** 鮮やかなグリーン (`#22C55E`)。または書き取り時の「朱色（はなまる）」。
*   **Destructive (Wrong):** 警告感の強すぎない赤・ピンク (`#EF4444` or `#F43F5E`)。
*   **Text:** 真っ黒ではなく、濃いグレー (`Slate-900`) でコントラストを確保しつつ柔らかく。

### 2.2. タイポグラフィ (Typography)
「読みやすさ」と「優しさ」を両立する丸ゴシック体を採用。

*   **Font Family:** `'M PLUS Rounded 1c'`, `'Hiragino Maru Gothic ProN'`, `sans-serif`
*   **Weight:**
    *   見出し・強調: `Bold (700)` or `ExtraBold (800)`
    *   本文: `Medium (500)` (子供向けにはRegularより少し太めが読みやすい)
*   **Size:**
    *   全体的に大きめ (`text-lg` を基本サイズとする)。

### 2.3. 角丸 (Radius)
「親しみやすさ」を表現するため、角丸は強めに設定。
*   `radius`: `0.75rem` (12px) 〜 `1rem` (16px)

---

## 3. UIコンポーネント設計 (Components with Shadcn UI)

Shadcn UIのコンポーネントを以下のようにカスタマイズ・利用します。

### 3.1. Buttons (`Button`)
*   **Primary (Adventure):** オレンジ背景、白文字。影（Shadow）をつけて立体感を出す。押下時に沈むアニメーション。
*   **Primary (Writing):** 藍色背景、白文字。和紙のような質感や、筆文字フォントを使用しても良い。
*   **Secondary:** 白背景、枠線あり。
*   **Ghost:** アイコンのみのボタン（設定、閉じるなど）。
*   **サイズ:** `h-12` や `h-14` など、通常より高さを確保。

### 3.2. Cards (`Card`)
*   **用途:** 図鑑のキャラクター表示、ステージ選択、アイテム表示。
*   **スタイル:** 白背景、強めの角丸、淡いシャドウ。ホバー時に浮き上がる (`hover:scale-105`) エフェクト。

### 3.3. Dialogs / Modals (`Dialog`)
*   **用途:** 結果発表、進化演出、保護者認証、書き順再生。
*   **スタイル:** 画面中央に表示。背景はブラー（`backdrop-blur-sm`）させる。閉じるボタンは大きくわかりやすく（「×」ではなく「とじる」ボタンも併設）。

### 3.4. Progress Bars (`Progress`)
*   **用途:** 経験値バー、なつき度、制限時間、書き取り進捗。
*   **スタイル:** 太め (`h-4` 以上)。色は中身によって変化（緑→黄→赤など）。ストライプアニメーションを入れるとゲームらしい。

### 3.5. Toasts (`Sonner` or `Toast`)
*   **用途:** 「保存しました」「アイテムゲット！」などの通知。
*   **スタイル:** 画面上部または中央に表示。アイコン付きで直感的に。

### 3.6. Icons (`Lucide React`)
*   わかりやすいメタファーを使用（例：ホーム＝家、図鑑＝本、設定＝歯車）。
*   線画（Outline）よりも、状況に応じて塗り（Solid）や色付きを使用する方が子供には認識しやすい場合がある。

### 3.7. Custom Game Components (New!)
Shadcn UIを拡張し、ゲーム体験に特化したコンポーネントを定義します。

#### A. `GameButton` (Responsive Feedback)
「手触り」と「反応」を統合したボタン。ロジックから分離して、ボタン自体が状態に応じた演出を持ちます。
*   **Click Effect:** 押下時に `scale-95` で沈み込むアニメーションを標準化。
*   **Variant "Correct":** `state="correct"` を渡すと、緑色に発光 + 弾ける (`Pop`) アニメーション + 正解音（SE）を自動再生。
*   **Variant "Wrong":** `state="wrong"` を渡すと、赤色 + 揺れる (`Shake`) アニメーション + 不正解音（SE）を自動再生。
*   **Particles:** `confetti={true}` プロパティで、クリック時に紙吹雪や星のエフェクトを発生させる。

#### B. `NarrativeProgress` (Story-driven Progress)
数字ではなく「物語の進行」を可視化するプログレスバー。
*   **Concept:** 単なる棒グラフではなく「道」として表現。
*   **Character Indicator:** バーの現在位置に、ユーザーのパートナーキャラクター（アイコン）を表示し、進捗に合わせて歩くアニメーションをさせる。
*   **Goal Visual:** バーの右端（100%地点）に「宝箱」や「ゴールフラッグ」を表示し、到達時の報酬を予感させる。

#### C. `EmotiveDialog` (Character-driven Communication)
システム通知ではなく、キャラクターからのメッセージとして伝えるダイアログ。
*   **Concept:** 枠線やヘッダーで「感情」を表現する。
*   **Variant "Joy" (報酬/クリア):** 枠が金色や虹色。ヘッダーから紙吹雪が垂れ下がる装飾。背景は明るい放射状パターン。
*   **Variant "Encourage" (失敗/リトライ):** 優しい暖色系。キャラクターが「おしい！」「どんまい！」と励ますイラストを添える。
*   **Variant "Zen" (書き取り):** 和紙テクスチャ背景。落ち着いた墨色の枠で、静かな集中を促す。

#### D. `CompanionGuide` (Micro-interaction)
UIの隅に常駐し、ガイドやリアクションを行うコンパニオンキャラクター。
*   **Concept:** システムメッセージではなく「相棒の言葉」として案内する。
*   **Loading:** スピナーの代わりに、キャラが一生懸命走ったり、漢字を運んだりするアニメーションを表示。
*   **Hover Guide:** 難しいボタンやアイコンにカーソルを合わせると、ひょこっと顔を出して吹き出しで説明（「これは おと の おおきさ だよ」）。
*   **Idle:** 一定時間操作がない場合、あくびをしたり、画面をコンコンと叩いたりして入力を促す。

---

## 4. 主要画面レイアウト (Key Screens)

### 4.1. ホーム画面 (Home / Hub)
「自分の部屋」や「冒険の拠点」を感じさせるデザイン。
*   **中央:** 現在のパートナーキャラクター。
*   **メインアクション:**
    *   **「よむ（青/緑）」ボタン:** おちものパズルへ。知的なイメージ。
    *   **「かく（赤/橙）」ボタン:** 書き取り奥義へ。情熱・修練のイメージ。
    *   2つのボタンを対等なサイズで配置し、どちらもメインコンテンツであることを示す。
*   **下部:** サブメニュー（図鑑、おやつ）。

### 4.2. 読みプレイ画面 (Reading Game)
（旧ゲーム画面と同様）
*   **プレイエリア:** 画面中央。視認性を最優先。
*   **HUD:** ライフ、スコア、時間。
*   **操作:** 下部に3択ボタン。

### 4.3. 書きプレイ画面 (Writing Game)
**集中力**を高める禅（Zen）のような、あるいは道場のような雰囲気。
*   **中央:** 巨大な漢字表示エリア。背景には「田」の字の補助線（グリッド）。
*   **なぞり書き:** 指でなぞると筆跡が残る（書道のような墨のエフェクト推奨）。
*   **アニメーション:** 「手本再生」ボタンで、一画ずつゆっくり書き順を再生。
*   **完了アクション:** 大きな「できた！」ボタンで次の問題へ。

### 4.4. マイルーム画面 (My Room) (New!)
「集める喜び」と「自分だけの場所」を感じさせる箱庭UI。
*   **レイアウト:** 画面全体を使ったアイソメトリック（斜め見下ろし）風、またはサイドビューの部屋。
*   **インタラクション:**
    *   **Drag & Drop:** キャラクターを自由に動かせる。
    *   **Tap:** キャラクターをタップすると、そのキャラ特有のアニメーション（ジャンプ、回転など）と吹き出しが出る。
    *   **Grid Snap:** 配置時にグリッドに吸着させることで、整頓しやすくする。
*   **演出:**
    *   **Interactive Background:** 背景の雲や木をタップすると揺れたり、鳥が飛んだりする。
    *   **Game State Reflection:** 残りライフが減ると夕方になったり、コンボが続くと背景がキラキラ輝いたりする（フィーバー演出）。
    *   BGMはゆったりとしたリラックス系。

### 4.5. 図鑑・保護者画面
*   **図鑑 (Collection):**
    *   グリッドレイアウトで取得済みキャラクターを一覧表示。
    *   未取得キャラはシルエット。
    *   タップで詳細モーダルを表示。
*   **保護者ダッシュボード (Parent):**
    *   シンプルで機能的なShadcn UIスタイル。
    *   学習進捗グラフや設定リストを表示。
    *   誤操作防止のための「保護者認証」モーダルを必須とする。

---

## 5. アニメーション & インタラクション (Animation & Interaction)
*   **筆跡エフェクト:** 書き取りモードでは、SVGパスアニメーションを用いて「筆で書いている」感覚を演出する。
*   **はなまる:** 書き取り完了時、画面に大きく赤い「はなまる」が描かれるアニメーションを入れる。
*   **コンパニオン:** ローディングやアイドリング時に、パートナーキャラによるマイクロインタラクションを挟む。

## 6. 技術スタック・ライブラリ
*   **Framework:** Next.js (App Router)
*   **Styling:** Tailwind CSS
*   **UI Components:** Shadcn UI
*   **Icons:** Lucide React
*   **Animation:** Framer Motion
*   **Font:** Google Fonts (`M PLUS Rounded 1c`)
*   **Canvas/SVG:** 書き取りのなぞり書き判定および描画に使用。
*   **Framer Motion / React-Draggable:** マイルームでのキャラクター配置・移動UIに使用。

## 7. レスポンシブ & デバイス対応方針 (Responsive Design)

ターゲット（7歳の子供）の利用シーンを想定し、タブレットでの操作性を最優先しつつ、スマホやPCでも快適に動作する設計とします。

### 7.1. ターゲットデバイス
1.  **タブレット (Main Target):** iPad, Androidタブレット (横持ち推奨)。
    *   広い画面で、書き取りやマイルームの操作が最も快適。
2.  **スマートフォン (Sub Target):** 親のスマホを借りてプレイ。
    *   要素が小さくなりすぎないよう、自動的にスタックレイアウトへ切り替え。
3.  **PC/Mouse (Dev/Sub):** 親のPCでプレイ。
    *   クリック・ドラッグ操作に対応。

### 7.2. レイアウト実装ルール
*   **アスペクト比固定 (Aspect Ratio):**
    *   「読みプレイ画面」「書きプレイ画面」のプレイエリアは、デバイスによらず一定のアスペクト比（例: 4:3 または 16:9）を維持する。
    *   画面サイズが変わっても「落下距離」や「書き取りエリアの広さ」が変わらないようにし、難易度を統一する。
    *   余白部分は装飾的な背景パターン（レターボックス）で埋める。
*   **文字サイズ (Typography):**
    *   Tailwindの `md:`, `lg:` プレフィックスを活用し、画面幅に応じて文字サイズをスケーリングする。
    *   最小文字サイズを `16px` とし、子供の視認性を確保する。

### 7.3. 入力インターフェース (Touch & Mouse)
*   **ライブラリ:** `react-use-gesture` 等を使用し、タッチイベントとマウスイベントを統一的に扱う。
*   **ドラッグ操作:** マイルームのキャラ移動や書き取りにおいて、指（Touch）とマウス（Mouse）の両方でスムーズに追従するように実装する。
*   **マルチタッチ無効化:** ゲーム中の誤操作を防ぐため、プレイエリア内ではピンチズーム等のデフォルトジェスチャーを無効化（`touch-action: none`）する。
